{% extends "base.html" %}
{% block content %}

<div class="container form-container">
    <h1 class="form-title">
        {% if ticket %}Editar Ticket{% else %}Crear Ticket{% endif %}
    </h1>

    <form method="POST" class="ticket-form">

        <!-- ================= DATOS DEL TICKET ================= -->
        <h2 class="section-title">Datos del ticket</h2>

        <label>Título</label>
        <input type="text" name="titulo" required
               value="{{ ticket.titulo if ticket else '' }}">

        <label>Descripción</label>
        <textarea name="descripcion" rows="4" required>{{ ticket.descripcion if ticket else '' }}</textarea>

        <div class="form-row">
            <div>
                <label>Fecha</label>
                <input type="date" name="fecha"
                       value="{{ ticket.fecha_creacion.strftime('%Y-%m-%d') if ticket and ticket.fecha_creacion }}">
            </div>
            <div>
                <label>Hora</label>
                <input type="time" name="hora"
                       value="{{ ticket.fecha_creacion.strftime('%H:%M') if ticket and ticket.fecha_creacion }}">
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Estado</label>
                <select name="estado">
                    {% for e in ["Nuevo","En Proceso","Resuelto"] %}
                    <option value="{{ e }}" {% if ticket and ticket.estado == e %}selected{% endif %}>{{ e }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label>Prioridad</label>
                <select name="prioridad">
                    {% for p in ["Baja","Media","Alta"] %}
                    <option value="{{ p }}" {% if ticket and ticket.prioridad == p %}selected{% endif %}>{{ p }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <!-- ================= CLIENTE ================= -->
        <h2 class="section-title">Datos del cliente</h2>

        <label>Nombre del cliente</label>
        <input type="text" name="nombre_cliente" required
               value="{{ ticket.nombre_cliente if ticket else '' }}">

        <div class="form-row">
            <div>
                <label>Teléfono</label>
                <input type="text" name="telefono_cliente"
                       value="{{ ticket.telefono_cliente if ticket else '' }}">
            </div>
            <div>
                <label>Correo</label>
                <input type="email" name="correo_cliente"
                       value="{{ ticket.correo_cliente if ticket else '' }}">
            </div>
        </div>

        <!-- ================= CLASIFICACIÓN ================= -->
        <h2 class="section-title">Clasificación</h2>

        <label>Tipo de problema</label>
<div class="checkbox-group">
    {% for p in ["Hardware", "Software", "Red", "Otro"] %}
    <label class="checkbox-item">
        <input type="radio" name="tipo_problema" value="{{ p }}"
        {% if ticket and ticket.tipo_problema == p %}checked{% endif %}>
        {{ p }}
    </label>
    {% endfor %}
</div>



        <label>Fuente del ticket</label>
<div class="checkbox-group">
    {% for f in ["Llamada", "Correo", "WebChat", "Presencial"] %}
    <label class="checkbox-item">
        <input type="checkbox" name="fuente_ticket" value="{{ f }}"
        {% if ticket and f in (ticket.fuente_ticket or "") %}checked{% endif %}>
        {{ f }}
    </label>
    {% endfor %}
</div>


        <!-- ================= SOPORTE ================= -->
        <h2 class="section-title">Soporte técnico</h2>

        <label>Técnico a cargo</label>
        <input type="text" name="tecnico_a_cargo"
               value="{{ ticket.tecnico_a_cargo if ticket else '' }}">

        <label>Medidas adoptadas</label>
        <textarea name="medidas_adoptadas" rows="3">{{ ticket.medidas_adoptadas if ticket else '' }}</textarea>

        <label>Resolución</label>
        <textarea name="resolucion" rows="3">{{ ticket.resolucion if ticket else '' }}</textarea>

        <!-- ================= BOTONES ================= -->
        <div class="form-actions">
            <button type="submit" class="btn-primary">
                {% if ticket %}Guardar cambios{% else %}Crear ticket{% endif %}
            </button>
            <a href="{{ url_for('ticket.list_tickets') }}" class="btn-secondary">Volver</a>
        </div>
        <div class="form-section">
    <label class="section-title">Tipo de problema</label>
    <div class="option-grid">
        {% for p in ["Hardware", "Software", "Red", "Otro"] %}
        <label class="option-item">
            <input type="radio"
                   name="tipo_problema"
                   value="{{ p }}"
                   {% if ticket and ticket.tipo_problema == p %}checked{% endif %}
                   required>
            <span>{{ p }}</span>
        </label>
        {% endfor %}
    </div>
</div>
<div class="form-section">
    <label class="section-title">Fuente del ticket</label>
    <div class="option-grid">
        {% for f in ["Llamada", "Correo", "WebChat", "Presencial"] %}
        <label class="option-item">
            <input type="checkbox"
                   name="fuente_ticket"
                   value="{{ f }}"
                   {% if ticket and f in (ticket.fuente_ticket or "") %}checked{% endif %}>
            <span>{{ f }}</span>
        </label>
        {% endfor %}
    </div>
</div>
<div class="form-section">
    <label class="section-title">Estado</label>
    <div class="option-grid">
        {% for e in ["Nuevo", "Apertura", "En proceso", "Resuelto", "Cierre", "Escalada"] %}
        <label class="option-item">
            <input type="radio"
                   name="estado"
                   value="{{ e }}"
                   {% if ticket and ticket.estado == e %}checked{% endif %}
                   required>
            <span>{{ e }}</span>
        </label>
        {% endfor %}
    </div>
</div>


    


    </form>
</div>

{% endblock %}
